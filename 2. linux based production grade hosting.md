# üöÄ **Production-Grade Deployment of Go-Todo on Linux VM (Vagrant + Native Services)**

This guide describes how to **deploy the Go-Todo Application** on a **Linux-based Virtual Machine (Ubuntu 22.04)** using **system services (no Docker)**.

This setup ensures:

* **Persistent MongoDB service**
* **Go backend managed by systemd**
* **React frontend served by Nginx**
* **Reverse proxy with HTTPS-ready configuration**
* **Production-grade isolation and auto-start behavior**

---

## 1Ô∏è‚É£ VM Provisioning with Vagrant

Create a `Vagrantfile` in your project root:

```ruby
Vagrant.configure("2") do |config|
  # Base Image
  config.vm.box = "generic/ubuntu2204"

  # VM Name
  config.vm.define "go-todo-vm"

  # Libvirt Provider
  config.vm.provider :libvirt do |libvirt|
    libvirt.name = "go-todo-vm"
    libvirt.memory = 4096
    libvirt.cpus = 2
  end

  # Bridged Network (for LAN access)
  config.vm.network "public_network", dev: "wlp0s20f3"
end
```

---

## 2Ô∏è‚É£ Launch VM and Connect

```bash
vagrant up
vagrant ssh
```

Find your VM IP:

```bash
ip a
```

Example:
**VM IP ‚Üí** `192.168.121.220`

---

## 3Ô∏è‚É£ Update System and Install Dependencies

```bash
sudo apt update && sudo apt upgrade -y
sudo apt install -y git curl nginx mongodb-org
```

> üß© If `mongodb-org` is not available, add the official MongoDB repo:

```bash
wget -qO - https://www.mongodb.org/static/pgp/server-7.0.asc | sudo apt-key add -
echo "deb [ arch=amd64,arm64 ] https://repo.mongodb.org/apt/ubuntu jammy/mongodb-org/7.0 multiverse" | sudo tee /etc/apt/sources.list.d/mongodb-org-7.0.list
sudo apt update && sudo apt install -y mongodb-org
```

Enable MongoDB at boot:

```bash
sudo systemctl enable mongod
sudo systemctl start mongod
sudo systemctl status mongod
```

---

## 4Ô∏è‚É£ Clone the Project

```bash
cd ~
git clone https://github.com/SAYEM-16T/go-todo-v1.git
cd go-todo-v1
```

Expected structure:

```
go-todo-v1/
‚îú‚îÄ‚îÄ auth-service/     # Go backend
‚îú‚îÄ‚îÄ frontend/         # React app
‚îú‚îÄ‚îÄ nginx/            # Reverse proxy configs
```

---

## 5Ô∏è‚É£ Build and Configure Backend (Go)

### üß± Install Go

```bash
sudo apt install -y golang-go
go version
```

### ‚öôÔ∏è Build the backend binary

```bash
cd ~/go-todo-v1/auth-service
go mod tidy
go build -o go-todo
```

### üìÅ Move to system location

```bash
sudo mkdir -p /opt/go-todo
sudo cp go-todo /opt/go-todo/
sudo cp -r .env /opt/go-todo/ 2>/dev/null || true
```

### üß© Create a systemd service

```bash
sudo nano /etc/systemd/system/go-todo.service
```

Paste this:

```ini
[Unit]
Description=Go Todo Backend Service
After=network.target mongod.service

[Service]
Type=simple
ExecStart=/opt/go-todo/go-todo
WorkingDirectory=/opt/go-todo
Restart=always
Environment=PORT=10000
Environment=MONGO_URL=mongodb://localhost:27017/todo
Environment=JWT_SECRET=supersecret

[Install]
WantedBy=multi-user.target
```

Enable and start:

```bash
sudo systemctl daemon-reload
sudo systemctl enable go-todo
sudo systemctl start go-todo
sudo systemctl status go-todo
```

---

## 6Ô∏è‚É£ Build and Configure Frontend (React + Vite)

Install Node.js and npm:

```bash
sudo apt install -y nodejs npm
node -v && npm -v
```

Build the frontend:

```bash
cd ~/go-todo-v1/frontend
npm install
npm run build
```

Deploy to Nginx web root:

```bash
sudo rm -rf /var/www/go-todo
sudo mkdir -p /var/www/go-todo
sudo cp -r dist/* /var/www/go-todo/
```

---

## 7Ô∏è‚É£ Configure Nginx (Reverse Proxy)

Edit default site config:

```bash
sudo nano /etc/nginx/sites-available/go-todo
```

Paste this:

```nginx
server {
    listen 80;
    server_name _;

    # Frontend
    root /var/www/go-todo;
    index index.html;

    # API requests ‚Üí Go backend
    location /api/ {
        proxy_pass http://127.0.0.1:10000/;
        proxy_set_header Host $host;
        proxy_set_header X-Real-IP $remote_addr;
        proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;
    }

    # Frontend routing
    location / {
        try_files $uri /index.html;
    }
}
```

Enable and restart Nginx:

```bash
sudo ln -s /etc/nginx/sites-available/go-todo /etc/nginx/sites-enabled/
sudo rm /etc/nginx/sites-enabled/default
sudo nginx -t
sudo systemctl restart nginx
```

---

## 8Ô∏è‚É£ Verify Setup

### Check running services:

```bash
sudo systemctl status mongod
sudo systemctl status go-todo
sudo systemctl status nginx
```

### Check ports:

```bash
sudo ss -tulnp | grep -E '10000|80'
```

### Access from your host machine:

```
http://192.168.121.220
```
üéØ screenshots :

![alt text](<Screenshot from 2025-10-03 02-12-46.png>)
![alt text](<Screenshot from 2025-10-03 02-15-38.png>)
![alt text](<Screenshot from 2025-10-03 02-15-57.png>)
![alt text](<Screenshot from 2025-10-02 23-46-53.png>)

You should see the React app, and API requests routed through `/api/`.

---

## 9Ô∏è‚É£ Production Hardening Checklist

‚úÖ Use `.env` files (in `/opt/go-todo`) for secrets
‚úÖ Set up `ufw` firewall:

```bash
sudo ufw allow 22
sudo ufw allow 80
sudo ufw enable
```

‚úÖ Enable HTTPS (optional):

```bash
sudo apt install -y certbot python3-certbot-nginx
sudo certbot --nginx
```

‚úÖ Enable automatic restarts:

```bash
sudo systemctl enable nginx
sudo systemctl enable mongod
sudo systemctl enable go-todo
```

---

## ‚úÖ Final Architecture (Manual Production Setup)

```
Host Browser
    ‚îÇ
    ‚ñº
[Nginx Reverse Proxy :80]
    ‚îÇ
 ‚îå‚îÄ‚îÄ‚îÄ‚î¥‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
 ‚îÇ                   ‚îÇ
 ‚ñº                   ‚ñº
Frontend (React)   Backend (Go)
 (served via       (systemd service)
   Nginx)               ‚îÇ
                        ‚ñº
                   MongoDB (local)
```

---

## ‚úÖ Summary

| Component      | Managed By | Port  | Description                    |
| -------------- | ---------- | ----- | ------------------------------ |
| Nginx          | systemd    | 80    | Reverse proxy + static hosting |
| Go Backend     | systemd    | 10000 | API server                     |
| MongoDB        | systemd    | 27017 | Persistent database            |
| React Frontend | Nginx      | ‚Äî     | Static UI                      |

