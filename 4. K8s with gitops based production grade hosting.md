
# Kubernetes Cluster Setup on AWS EC2 with Kind and Argo CD

This repository contains the setup and deployment instructions for running a **Kubernetes cluster on an AWS EC2 instance** using **Kind (Kubernetes in Docker)** and **Argo CD** for GitOps-based deployment.

---

## Table of Contents

- [Prerequisites](#prerequisites)
- [Step 1: Launch EC2 Instance](#step-1-launch-ec2-instance)
- [Step 2: Connect to EC2 via SSH](#step-2-connect-to-ec2-via-ssh)
- [Step 3: Install Docker](#step-3-install-docker)
- [Step 4: Install Kind and Configure Cluster](#step-4-install-kind-and-configure-cluster)
- [Step 5: Install Kubectl](#step-5-install-kubectl)
- [Step 6: Install Argo CD](#step-6-install-argo-cd)
- [Step 7: Access Argo CD in Browser](#step-7-access-argo-cd-in-browser)

---

## Prerequisites

- AWS Account with permissions to create EC2 instances.
- SSH key pair for EC2 access.
- Basic understanding of Kubernetes and GitOps concepts.

---

## Step 1: Launch EC2 Instance

1. Go to **EC2 Dashboard → Launch Instance**.
2. Configure instance:
   - **Name:** `kubernetes-cluster`
   - **AMI:** `Ubuntu Server 24.04 LTS (64-bit)`
   - **Instance Type:** `c7i-flex.large` (2 vCPU, 4 GiB RAM)
   - **Key Pair:** `devops-live-project-k8s`
   - **Network:** Default VPC/subnet
   - **Auto-assign Public IP:** Enabled
3. Configure Security Group to allow:
   - SSH: `22` from your IP
   - HTTP: `80` from anywhere
   - HTTPS: `443` from anywhere
4. Add storage (default: 15 GiB, gp3)
5. Launch instance.

---

## Step 2: Connect to EC2 via SSH

```bash
chmod 400 devops-live-project-k8s.pem
ssh -i "devops-live-project-k8s.pem" ubuntu@<EC2-Public-DNS>
````

Replace `<EC2-Public-DNS>` with your instance public DNS.

---

## Step 3: Install Docker

```bash
sudo apt-get update
sudo apt-get install -y docker.io
sudo systemctl enable docker
sudo systemctl start docker
docker --version
```

---

## Step 4: Install Kind and Configure Cluster

1. Create a directory for installation scripts:

```bash
mkdir ~/k8s-install && cd ~/k8s-install
```

2. Install Kind:

```bash
# Example script: install_kind.sh
curl -Lo ./kind https://kind.sigs.k8s.io/dl/v0.20.0/kind-linux-amd64
chmod +x ./kind
sudo mv ./kind /usr/local/bin/kind
kind --version
```

3. Create a 3-node cluster using a config file `config.yml`:

```bash
kind create cluster --config=config.yml --name=my-cluster
kubectl cluster-info --context kind-my-cluster
kubectl get nodes
```

---

## Step 5: Install Kubectl

```bash
# Example script: install_kubectl.sh
curl -LO "https://dl.k8s.io/release/v1.30.0/bin/linux/amd64/kubectl"
chmod +x kubectl
sudo mv kubectl /usr/local/bin/
kubectl version --client
```

---

## Step 6: Install Argo CD

```bash
# Create namespace
kubectl create namespace argocd

# Install Argo CD
kubectl apply -n argocd -f https://raw.githubusercontent.com/argoproj/argo-cd/stable/manifests/install.yaml

# Expose Argo CD server via NodePort
kubectl patch svc argocd-server -n argocd -p '{"spec": {"type": "NodePort"}}'
```

Get the Argo CD initial admin password:

```bash
kubectl get secret -n argocd argocd-initial-admin-secret -o jsonpath="{.data.password}" | base64 -d && echo
```

---

## Step 7: Access Argo CD in Browser

1. Forward the port from EC2:

```bash
kubectl port-forward -n argocd svc/argocd-server 8443:443 --address=0.0.0.0
```

2. Open in your browser:

```
https://<EC2-Public-IP>:8443
```

3. Login with:

* **Username:** `admin`
* **Password:** `<password from previous step>`

> ⚠️ You may need to proceed past the SSL warning.

---

## ✅ Next Steps

* Start deploying applications using Argo CD.
* Connect Argo CD to your GitHub repositories.
* Use Kubernetes manifests or Helm charts for deployment.

---

## References

* [Kind Quick Start](https://kind.sigs.k8s.io/docs/user/quick-start/)
* [Argo CD Documentation](https://argo-cd.readthedocs.io/en/stable/)
* [AWS EC2 Documentation](https://docs.aws.amazon.com/ec2/index.html)
